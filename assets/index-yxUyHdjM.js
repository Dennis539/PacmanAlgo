var $=Object.defineProperty;var J=(n,e,t)=>e in n?$(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var h=(n,e,t)=>(J(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const C of s)if(C.type==="childList")for(const f of C.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const C={};return s.integrity&&(C.integrity=s.integrity),s.referrerPolicy&&(C.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?C.credentials="include":s.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function i(s){if(s.ep)return;s.ep=!0;const C=t(s);fetch(s.href,C)}})();class Q{constructor(e,t,i,s,C,f,W,d){h(this,"height");h(this,"width");h(this,"xPos");h(this,"yPos");h(this,"xMiddle");h(this,"yMiddle");h(this,"type");h(this,"wallDir");h(this,"lineBeginX");h(this,"lineBeginY");h(this,"lineEndX");h(this,"lineEndY");h(this,"neighbors");h(this,"color");this.height=20,this.width=20,this.xPos=e,this.yPos=t,this.xMiddle=this.xPos+10,this.yMiddle=this.xPos+10,this.type="Wall",this.wallDir=i,this.lineBeginX=s,this.lineBeginY=C,this.lineEndX=f,this.lineEndY=W,this.neighbors=[],this.color=d}}class D{constructor(e,t,i){h(this,"height");h(this,"width");h(this,"xPos");h(this,"yPos");h(this,"xMiddle");h(this,"yMiddle");h(this,"type");h(this,"neighbors");h(this,"lighter");h(this,"darker");h(this,"lightness");h(this,"color");this.height=8,this.width=8,this.xPos=e,this.yPos=t,this.xMiddle=this.xPos+10,this.yMiddle=this.yPos+10,this.type=i,this.neighbors=[],this.lighter=!0,this.darker=!1,this.lightness=50,this.color=""}updateLightness(){this.lighter&&this.lightness<100?this.lightness+=1:this.lightness>=100?(this.lighter=!1,this.darker=!0,this.lightness-=1):this.darker&&this.lightness>50?this.lightness-=1:this.darker&&this.lightness<=50&&(this.lighter=!0,this.darker=!1,this.lightness+=1)}}class Z{constructor(e,t,i){h(this,"debug");h(this,"height");h(this,"width");h(this,"xPos");h(this,"yPos");h(this,"steps");h(this,"boardMatrix");h(this,"middlePosTile");h(this,"chaseTimeOut");h(this,"scatterTimeOut");h(this,"frightenedTimeOut");h(this,"lifeLost");h(this,"time");h(this,"setPinky");h(this,"setClyde");h(this,"setInky");h(this,"flicker");h(this,"gameOverScreen");this.debug=!0,this.height=600,this.width=0,this.xPos=150,this.yPos=150,this.steps=20,this.boardMatrix=[],this.createBoard(),this.middlePosTile=this.calculateMiddlePosTile(),this.chaseTimeOut=e,this.scatterTimeOut=t,this.frightenedTimeOut=i,this.lifeLost=!1,this.time=1,this.setPinky=!1,this.setClyde=!1,this.setInky=!1,this.flicker=0,this.gameOverScreen=!1}calculateMiddlePosTile(){let e=[];for(let t=0;t<this.boardMatrix.length;t++)for(let i=0;i<this.boardMatrix[t].length;i++)this.boardMatrix[t][i]&&e.push([this.boardMatrix[t][i].xPos+10,this.boardMatrix[t][i].yPos+10]);return e}createBoard(){let e;var t=["W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	N	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W","W	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	W	N	W	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	W","W	C	W	W	W	W	C	W	W	W	C	C	W	W	W	W	C	W	N	W	C	WR	WR	WR	WR	WR	WR	WR	WR	C	WY	WY	WY	WY	WY	WY	WY	WY	C	WG	WG	WG	WG	WG	WG	WG	WG	C	W	W	W	W	W	W	W	C	W","W	C	W	W	W	W	C	W	W	W	C	W	W	W	W	W	C	W	W	W	C	WR	W	W	W	W	W	W	WR	C	WY	W	W	W	W	W	W	WY	C	WG	W	W	W	W	W	W	WG	C	W	W	W	W	W	W	W	C	W","W	CP	C	C	C	C	C	W	W	W	W	W	W	W	W	C	C	C	C	C	C	WR	W	WR	WR	WR	WR	WR	WR	C	WY	W	WY	WY	WY	WY	WY	WY	C	WG	W	WG	WG	WG	WG	WG	WG	C	C	C	C	C	C	C	C	CP	W","W	W	W	W	W	W	C	W	W	W	W	W	W	W	C	C	W	W	W	W	C	WR	W	WR	CP	C	C	C	C	C	WY	W	WY	C	C	C	C	C	C	WG	W	WG	C	C	C	C	C	C	W	W	C	W	W	W	W	W	W","N	N	N	N	N	W	C	W	W	W	W	W	W	W	C	W	W	N	N	W	C	WR	W	WR	WR	WR	WR	WR	WR	C	WY	W	WY	WY	WY	WY	WY	WY	C	WG	W	WG	WG	WG	WG	WG	WG	C	W	W	C	W	N	N	N	N	N","W	W	W	W	W	W	C	W	W	W	W	W	W	C	C	W	N	N	N	W	C	WR	W	W	W	W	W	W	WR	C	WY	W	W	W	W	W	W	WY	C	WG	W	W	W	W	W	W	WG	C	W	W	C	W	W	W	W	W	W","WN	C	C	C	C	C	C	W	W	W	W	W	W	W	C	W	W	N	N	W	C	WR	W	WR	WR	WR	WR	WR	WR	C	WY	W	WY	WY	WY	WY	WY	WY	C	WG	WG	WG	WG	WG	WG	W	WG	C	W	W	C	C	C	C	C	C	W","W	W	W	W	W	W	C	W	W	W	W	W	W	W	C	C	W	W	W	W	C	WR	W	WR	C	C	C	C	C	C	WY	W	WY	C	C	C	C	C	C	C	C	C	C	C	WG	W	WG	C	W	W	C	W	W	W	W	W	W","N	N	N	N	N	W	C	W	W	W	W	W	W	W	W	C	C	C	C	C	C	WR	W	WR	WR	WR	WR	WR	WR	C	WY	W	WY	WY	WY	WY	WY	WY	C	WG	WG	WG	WG	WG	WG	W	WG	C	W	W	C	W	N	N	N	N	N","W	W	W	W	W	W	C	W	W	W	C	W	W	W	W	W	C	W	W	W	C	WR	W	W	W	W	W	W	WR	C	WY	W	W	W	W	W	W	WY	C	WG	W	W	W	W	W	W	WG	C	C	C	C	W	W	W	W	W	W","W	C	C	C	C	C	C	W	W	W	C	C	W	W	W	W	C	W	N	W	C	WR	WR	WR	WR	WR	WR	WR	WR	C	WY	WY	WY	WY	WY	WY	WY	WY	C	WG	WG	WG	WG	WG	WG	WG	WG	C	W	W	C	C	C	C	C	C	W","W	C	W	W	W	W	C	C	C	C	C	C	C	C	C	C	C	W	N	W	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	W	W	W	C	W	W	W	C	W","W	C	W	W	W	W	C	W	W	W	W	W	W	W	W	W	C	W	N	W	C	W	W	W	W	W	W	W	W	W	W	W	C	W	W	C	W	W	W	W	W	W	W	W	W	W	W	C	W	W	W	C	W	W	W	C	W","W	C	W	W	W	W	C	W	W	W	W	W	W	W	W	W	C	W	N	W	C	W	W	W	W	W	W	W	W	W	W	W	C	W	W	C	W	W	W	W	W	W	W	W	W	W	W	C	W	W	W	C	W	W	W	C	W","W	CP	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	W	N	W	C	C	C	C	C	C	C	C	C	C	C	C	C	W	W	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	C	CP	W","W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	N	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W	W"],i=this.xPos+50,s=this.yPos+50;this.width=t[0].split("	").length*this.steps+100,this.height=t.length*this.steps+100;var C="";e=t.map(l=>l.split("	"));let f=1,W=1,d=1,a=1;for(let l=0;l<e.length;l++){var c=[];for(let o=0;o<e[l].length;o++){if(e[l][o].includes("W")){o===0||l===0||o===e[l].length-1||l===e.length-1?l<e.length-1&&o<e[0].length-1&&e[l+1][o+1].includes("C")&&e[l][o+1].includes("W")&&e[l+1][o].includes("W")?(C="rightToBottom",f=i+20,W=s+10,d=i+10,a=s+20):o<e[0].length-1&&l>0&&e[l-1][o+1].includes("C")&&e[l][o+1].includes("W")&&e[l-1][o].includes("W")?(C="rightToTop",f=i+20,W=s+10,d=i+10,a=s):l<e.length-1&&o>0&&e[l+1][o-1].includes("C")&&e[l][o-1].includes("W")&&e[l+1][o].includes("W")?(C="leftToBottom",f=i+20,W=s+10,d=i+10,a=s+20):l>0&&o>0&&e[l-1][o-1].includes("C")&&e[l][o-1].includes("W")&&e[l-1][o].includes("W")?(C="leftToTop",f=i,W=s,d=i+10,a=s+10):l===0||l===e.length-1?(C="leftToRight",f=i,W=s+10,d=i+20,a=s+10):(o===0||o===e[0].length-1)&&(C="upToBottom",f=i+10,W=s,d=i+10,a=s+20):o!==0&&o!==e[l].length-1&&l!==0&&l!==e.length-1&&(e[l-1][o].includes("W")&&e[l+1][o].includes("W")&&e[l][o-1].includes("W")&&e[l][o+1].includes("W")&&e[l-1][o-1].includes("W")&&e[l+1][o+1].includes("W")&&e[l+1][o-1].includes("W")&&e[l-1][o+1].includes("W")?(C="surrounded",f=i+10,W=s,d=i+10,a=s+20):e[l-1][o-1].includes("C")&&!e[l+1][o+1].includes("C")&&e[l-1][o+1].includes("C")&&e[l+1][o-1].includes("C")||!e[l-1][o-1].includes("C")&&e[l+1][o+1].includes("C")&&!e[l-1][o+1].includes("C")&&!e[l+1][o-1].includes("C")&&!e[l+1][o].includes("C")&&!e[l][o+1].includes("C")||e[l-1][o-1].includes("C")&&e[l-1][o].includes("C")&&e[l][o-1].includes("C")?(C="rightToBottom",f=i+20,W=s+10,d=i+10,a=s+20):e[l-1][o-1].includes("C")&&e[l+1][o+1].includes("C")&&e[l-1][o+1].includes("C")&&!e[l+1][o-1].includes("C")||!e[l-1][o-1].includes("C")&&!e[l+1][o+1].includes("C")&&!e[l-1][o+1].includes("C")&&e[l+1][o-1].includes("C")&&!e[l][o-1].includes("C")&&!e[l+1][o].includes("C")&&!e[l][o+1].includes("C")||e[l-1][o].includes("C")&&e[l-1][o+1].includes("C")&&e[l][o+1].includes("C")?(C="leftToBottom",f=i,W=s+10,d=i+10,a=s+20):e[l-1][o-1].includes("C")&&e[l+1][o+1].includes("C")&&!e[l-1][o+1].includes("C")&&e[l+1][o-1].includes("C")||!e[l-1][o-1].includes("C")&&!e[l+1][o+1].includes("C")&&e[l-1][o+1].includes("C")&&!e[l+1][o-1].includes("C")&&!e[l-1][o].includes("C")&&!e[l][o+1].includes("C")||e[l][o-1].includes("C")&&e[l+1][o-1].includes("C")&&e[l+1][o].includes("C")?(C="rightToTop",f=i+20,W=s+10,d=i+10,a=s):!e[l-1][o-1].includes("C")&&e[l+1][o+1].includes("C")&&e[l-1][o+1].includes("C")&&e[l+1][o-1].includes("C")||e[l-1][o-1].includes("C")&&!e[l+1][o+1].includes("C")&&!e[l-1][o+1].includes("C")&&!e[l+1][o-1].includes("C")&&!e[l-1][o].includes("C")&&!e[l][o-1].includes("C")||e[l][o+1].includes("C")&&e[l+1][o+1].includes("C")&&e[l+1][o].includes("C")?(C="leftToTop",f=i+10,W=s,d=i+10,a=s+20):e[l][o-1].includes("W")&&e[l][o+1].includes("W")?(C="leftToRight",f=i,W=s+10,d=i+20,a=s+10):e[l-1][o].includes("W")&&e[l+1][o].includes("W")?(C="upToBottom",f=i+10,W=s,d=i+10,a=s+20):(C="",f=i+10,W=s,d=i+10,a=s+20));let P;e[l][o]==="WR"?P="red":e[l][o]==="WG"?P="lawngreen":e[l][o]==="WY"?P="yellow":P="blue",c.push(new Q(i,s,C,f,W,d,a,P))}else e[l][o].includes("C")?e[l][o]==="CP"?c.push(new D(i,s,"PowerUpCoin")):c.push(new D(i,s,"Coin")):e[l][o]==="N"?c.push(new D(i,s,"None")):c.push(null);i+=20}this.boardMatrix.push(c),s+=20,i=this.xPos+50}for(let l=0;l<this.boardMatrix.length;l++)for(let o=0;o<this.boardMatrix[l].length;o++)this.boardMatrix[l][o]&&(l===0?o===0?this.boardMatrix[l][o].neighbors=[null,this.boardMatrix[l+1][o],this.boardMatrix[l][o+1],null]:o===this.boardMatrix[l].length-1?this.boardMatrix[l][o].neighbors=[null,this.boardMatrix[l+1][o],null,this.boardMatrix[l][o-1]]:this.boardMatrix[l][o].neighbors=[null,this.boardMatrix[l+1][o],this.boardMatrix[l][o+1],this.boardMatrix[l][o-1]]:l===this.boardMatrix.length-1?o===0?this.boardMatrix[l][o].neighbors=[this.boardMatrix[l-1][o],null,this.boardMatrix[l][o+1],null]:o===this.boardMatrix[l].length-1?this.boardMatrix[l][o].neighbors=[this.boardMatrix[l-1][o],null,null,this.boardMatrix[l][o-1]]:this.boardMatrix[l][o].neighbors=[this.boardMatrix[l-1][o],null,this.boardMatrix[l][o+1],this.boardMatrix[l][o-1]]:o===0?this.boardMatrix[l][o].neighbors=[this.boardMatrix[l-1][o],this.boardMatrix[l+1][o],this.boardMatrix[l][o+1],null]:o===this.boardMatrix[l].length-1?this.boardMatrix[l][o].neighbors=[this.boardMatrix[l-1][o],this.boardMatrix[l+1][o],null,this.boardMatrix[l][o-1]]:this.boardMatrix[l][o].neighbors=[this.boardMatrix[l-1][o],this.boardMatrix[l+1][o],this.boardMatrix[l][o+1],this.boardMatrix[l][o-1]])}checkPlayerWallCollision(e,t,i){for(let s=0;s<this.boardMatrix.length;s++)for(let C of this.boardMatrix[s]){if(!C||C.type!=="Wall")continue;let f=C;if(f.wallDir==="upToBottom"){let W=f.lineBeginX-1,d=f.yPos;for(let a=0;a<20;a++){const c=W-t,l=d-i,o=(c*c+l*l)**.5,P=t<W?1:2;if(o<e.radius+P)return a===19&&(W<=e.xPos?e.xPos+=2:e.xPos-=2),!0;d+=1}}else if(f.wallDir==="leftToRight"){let W=f.xPos,d=f.lineBeginY-1;for(let a=0;a<20;a++){const c=W-t,l=d-i,o=(c*c+l*l)**.5,P=i<d?1:2;if(o<e.radius+P)return!0;W+=1}}else if(f.wallDir==="rightToBottom"){let W=f.xPos+19,d=f.yPos+9;for(let a=0;a<10;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="right"?(e.yPos-=2,!0):(e.direction==="down"&&(e.xPos-=2),!0);W-=1}for(let a=0;a<10;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="right"?(e.yPos-=2,!0):(e.direction==="down"&&(e.xPos-=2),!0);d+=1}}else if(f.wallDir==="leftToBottom"){let W=f.xPos,d=f.yPos+9;for(let a=0;a<10;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="left"?(e.yPos-=2,!0):(e.direction==="down"&&(e.xPos+=2),!0);W+=1}for(let a=0;a<10;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="left"?(e.yPos-=2,!0):(e.direction==="down"&&(e.xPos+=2),!0);d+=1}}else if(f.wallDir==="rightToTop"){let W=f.xPos+19,d=f.yPos+10;for(let a=0;a<10;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="right"?(e.yPos+=2,!0):(e.direction==="up"&&(e.xPos-=2),!0);W-=1}for(let a=0;a<10;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="right"?(e.yPos+=2,!0):(e.direction==="up"&&(e.xPos-=2),!0);d-=1}}else if(f.wallDir==="leftToTop"){let W=f.xPos,d=f.yPos+9;for(let a=0;a<11;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="left"?(e.yPos+=2,!0):(e.direction==="up"&&(e.xPos+=2),!0);W+=1}for(let a=0;a<11;a++){const c=W-t,l=d-i;if((c*c+l*l)**.5<e.radius+1)return e.direction==="left"?(e.yPos+=1,!0):(e.direction==="up"&&(e.xPos+=2),!0);d-=1}}}return!1}playerCoinCollision(e,t){let i=0,s=0;e.xPos<t.xPos?i=t.xPos:e.xPos>t.xPos+t.width&&(i=t.xPos+t.width+9),e.yPos<t.yPos?s=t.yPos:e.yPos>t.yPos+t.height&&(s=t.yPos+t.height+9);const C=e.xPos-i,f=e.yPos-s;if((C*C+f*f)**.5<=e.radius){e.score+=100;let d=t.type;return t.type="Tile",d}return null}checkPlayerGhostcollision(e,t){let i=t.xPos-e.xPos,s=t.yPos-e.yPos;if(Math.sqrt(i*i+s*s)<e.radius+t.radius)if(!e.touched&&e.frightened){const f=this.boardMatrix[e.tile[0]][e.tile[1]];e.xPos=f.xMiddle,e.yPos=f.yMiddle,e.speed=10,e.touched=!0}else e.speed===10||(this.lifeLost=!0,t.startAngle=Math.PI*1.5,t.endAngle=Math.PI*1.5-.05)}endFrightened(e){e.frightened=!1,e.touched=!1,e.name==="Blinky"&&(e.color="red"),e.name==="Pinky"&&(e.color="pink"),e.name==="Inky"&&(e.color="lightblue"),e.name==="Clyde"&&(e.color="orange"),e.speed=2}}class ee{constructor(e,t,i,s,C){h(this,"x");h(this,"y");h(this,"radius");h(this,"dx");h(this,"dy");h(this,"alpha");this.x=e,this.y=t,this.radius=i,this.dx=s,this.dy=C,this.alpha=1}draw(e){e.save(),e.globalAlpha=this.alpha,e.fillStyle="yellow",e.beginPath(),e.arc(this.x,this.y,this.radius,0,Math.PI*2,!1),e.fill(),e.restore()}update(e){this.draw(e),this.alpha-=.01,this.x+=this.dx,this.y+=this.dy}}class X{constructor(e,t){h(this,"xPos");h(this,"yPos");h(this,"radius");h(this,"direction");h(this,"mouthDirection");h(this,"speed");h(this,"score");h(this,"startAngle");h(this,"endAngle");h(this,"eat");h(this,"tile");h(this,"fourTilesAhead");h(this,"lives");h(this,"dead");h(this,"explosion");this.xPos=610,this.yPos=490,this.radius=18,this.speed=2,this.direction="Kees",this.mouthDirection="Open",this.score=t,this.startAngle=Math.PI*1.5,this.endAngle=Math.PI*1.5-.05,this.eat=!1,this.tile=[Math.floor((this.yPos-200)/20),Math.floor((this.xPos-200)/20)],this.fourTilesAhead=[Math.floor((this.yPos-200)/20)-4,Math.floor((this.xPos-200)/20)],this.lives=e,this.dead=!1,this.explosion=null}updateDirection(e,t){let i=this.tile[1],s=this.tile[0];"ArrowLeft"in e?(i<=4?this.fourTilesAhead=this.findEligibleTile(t,s,1):t.boardMatrix[s][i-4]&&t.boardMatrix[s][i-4].type!=="Wall"&&t.boardMatrix[s][i-4].type!=="None"&&(this.fourTilesAhead=this.findEligibleTile(t,s,i-4)),this.direction!=="left"&&(this.direction="left",this.startAngle=Math.PI,this.endAngle=Math.PI-.05,this.mouthDirection="Open")):"ArrowRight"in e?(t.boardMatrix[0].length-1-i<=4?this.fourTilesAhead=this.findEligibleTile(t,s,t.boardMatrix[0].length-2):t.boardMatrix[s][i+4]&&t.boardMatrix[s][i+4].type!=="Wall"&&t.boardMatrix[s][i+4].type!=="None"&&(this.fourTilesAhead=this.findEligibleTile(t,s,i+4)),this.direction!=="right"&&(this.direction="right",this.startAngle=0,this.endAngle=-.05,this.mouthDirection="Open")):"ArrowUp"in e?(s<=4?this.fourTilesAhead=this.findEligibleTile(t,1,i):t.boardMatrix[s-4][i]&&t.boardMatrix[s-4][i].type!=="Wall"&&t.boardMatrix[s-4][i].type!=="None"&&(this.fourTilesAhead=this.findEligibleTile(t,s-4,i)),this.direction!=="up"&&(this.direction="up",this.startAngle=Math.PI*1.5,this.endAngle=Math.PI*1.5-.05,this.mouthDirection="Open")):"ArrowDown"in e&&(t.boardMatrix.length-1-s<=4?this.fourTilesAhead=this.findEligibleTile(t,t.boardMatrix.length-2,i):t.boardMatrix[s+4][i]&&t.boardMatrix[s+4][i].type!=="Wall"&&t.boardMatrix[s+4][i].type!=="None"&&(this.fourTilesAhead=this.findEligibleTile(t,s+4,i)),this.direction!=="down"&&(this.direction="down",this.startAngle=Math.PI/2,this.endAngle=Math.PI/2-.05,this.mouthDirection="Open"))}findEligibleTile(e,t,i){let s=[""];function C(f,W,d,a){let c=[...Array(a.boardMatrix[0].length).keys()];if(!(![...Array(a.boardMatrix.length).keys()].includes(W)||!c.includes(d)||f.includes([W,d].toString())))if(!a.boardMatrix[W][d]||a.boardMatrix[W][d].type==="Wall"||a.boardMatrix[W][d].type==="None"){f.includes([W,d].toString())||f.push([W,d].toString());let o=[[W,d+1],[W,d-1],[W+1,d],[W-1,d]];for(let P of o){let x=C(f,P[0],P[1],a);if(x)return[x[0],x[1]]}}else return[W,d]}return C(s,t,i,e)}move(e,t){"ArrowLeft"in e?this.xPos-=this.speed:"ArrowRight"in e?this.xPos+=this.speed:"ArrowUp"in e?this.yPos-=this.speed:"ArrowDown"in e&&(this.yPos+=this.speed),this.tile=[Math.floor((this.yPos-200)/20),Math.floor((this.xPos-200)/20)],this.updateDirection(e,t)}caught(){this.startAngle+=.08,this.endAngle-=.08}createExplosion(e){let t=[];for(let i=0;i<=150;i++){let s=(Math.random()-.5)*(Math.random()*6),C=(Math.random()-.5)*(Math.random()*6),f=Math.random()*3;const W=e.xPos+4/2,d=e.yPos+4/2;let a=new ee(W,d,f,s,C);t.push(a)}return t}}class E{constructor(e){h(this,"xPos");h(this,"yPos");h(this,"radius");h(this,"direction");h(this,"speed");h(this,"color");h(this,"neighbors");h(this,"nextTileCoord");h(this,"prevTileCoord");h(this,"preVisited");h(this,"tile");h(this,"mode");h(this,"home");h(this,"homeTarget");h(this,"name");h(this,"endTile");h(this,"frightened");h(this,"beginTimeMode");h(this,"endTimeMode");h(this,"beginTimeFrightened");h(this,"endTimeFrightened");h(this,"phaseChange");h(this,"touched");h(this,"hasEntered");h(this,"algorithm");h(this,"showAlgorithm");h(this,"showAlgorithmStep");h(this,"path");this.xPos=590,this.yPos=510,this.radius=18,this.speed=2,this.direction="right",this.color="",this.neighbors=[],this.nextTileCoord=[],this.prevTileCoord=[],this.preVisited=e.boardMatrix[0][0],this.tile=[(this.yPos-210)/20,(this.xPos-210)/20],this.mode="chase",this.home=[e.boardMatrix[0][0],e.boardMatrix[0][0]],this.homeTarget=e.boardMatrix[0][0],this.name="Blinky",this.endTile=e.boardMatrix[0][0],this.frightened=!1,this.beginTimeMode=Math.floor(Date.now()/1e3),this.endTimeMode=Math.floor(Date.now()/1e3),this.beginTimeFrightened=0,this.endTimeFrightened=0,this.phaseChange=!1,this.touched=!1,this.hasEntered=!1,this.algorithm="Dijkstra",this.showAlgorithm=!1,this.showAlgorithmStep=[],this.path=[]}_determineEndtile(e,t,i){let s;return this.mode==="chase"?s=e.boardMatrix[t][i]:this.mode==="scatter"?s=this.homeTarget:s=e.boardMatrix[t][i],s}_moveToCenterOfTile(){this.xPos<this.nextTileCoord[0]?this.xPos+=this.speed:this.xPos>this.nextTileCoord[0]?this.xPos-=this.speed:this.yPos<this.nextTileCoord[1]?this.yPos+=this.speed:this.yPos>this.nextTileCoord[1]&&(this.yPos-=this.speed)}_determine_neighbors(e){for(let t=0;t<e.length;t++)for(let i=0;i<e[t].length;i++){let s=e[t][i];s&&this.xPos>=s.xPos&&this.xPos<=s.xPos+19&&this.yPos>=s.yPos&&this.yPos<=s.yPos+19&&(this.neighbors=s.neighbors)}}_assignRandomNextTileCoord(){for(let e of this.neighbors)if(e.type!=="Wall"&&e.type!=="None"&&e!=this.preVisited)return[e.xMiddle,e.yMiddle];return[210,210]}_determineErrorSpot(e,t,i){return e==="Pinky"&&t.length<=2&&i!=="scatter"||e==="Inky"&&t.length<=2&&i!=="scatter"||e==="Clyde"&&t.length<=8&&i!=="scatter"}_determineNextTilePos(e,t,i,s){if(e.length<=1&&this.touched){this.xPos=490,this.yPos=350;return}e.length<=2&&this.mode==="scatter"&&(this.homeTarget===this.home[0]?this.homeTarget=this.home[1]:this.homeTarget=this.home[0]),this._determineErrorSpot(t,e,i)?(this.nextTileCoord=this._assignRandomNextTileCoord(),t==="Clyde"&&(this.mode="scatter")):(this.prevTileCoord=this.nextTileCoord,this.algorithm==="dfs"?this.nextTileCoord=[e[e.length-1].xMiddle,e[e.length-1].yMiddle]:this.nextTileCoord=[e[e.length-2].xMiddle,e[e.length-2].yMiddle]),this.preVisited=s.boardMatrix[this.tile[0]][this.tile[1]],this._moveToCenterOfTile()}_dfs(e,t,i,s){let C=(this.endTile.yMiddle-210)/20,f=(this.endTile.xMiddle-210)/20;if([i,t].toString()===[C,f].toString())return console.log("found Kees"),[s.boardMatrix[i][t]];let W=[...Array(s.boardMatrix[0].length).keys()];if(![...Array(s.boardMatrix.length).keys()].includes(i)||!W.includes(t)||e.includes([i,t].toString())||s.boardMatrix[i][t].type==="Wall"||s.boardMatrix[i][t]===this.preVisited)return;e.push([i,t].toString()),this.showAlgorithmStep.push(s.boardMatrix[i][t]);let a=[[t-1,i],[t+1,i],[t,i-1],[t,i+1]];for(let c of a){let l=c[0],o=c[1],P=this._dfs(e,l,o,s);if(P)return P.push(s.boardMatrix[o][l]),P}}_dfsAlgorithm(e,t,i){let s=this._dfs([],this.tile[1],this.tile[0],e);s&&(this.path=s,this._determineNextTilePos(s,t,i,e))}_bfs(e,t,i,s,C){let f=new Map,W=[],d=[],a=[],c=[Math.floor((t.yPos-200)/20),Math.floor((t.xPos-200)/20)];for(d.push(e);d.length!==0;){let l=d;for(let o of l){let P=d.shift(),x=[Math.floor((P.yPos-200)/20),Math.floor((P.xPos-200)/20)];if(x.toString()===c.toString()){for(;Array.from(f.keys()).includes(P);)P=f.get(P),a.push(P);this._determineNextTilePos(a,s,C,i),this.path=a;return}let m=[[x[0]-1,x[1]],[x[0]+1,x[1]],[x[0],x[1]-1],[x[0],x[1]+1]],p=[...Array(i.boardMatrix[0].length).keys()],T=[...Array(i.boardMatrix.length).keys()];for(let y of m){let w=y[0],A=y[1],v=i.boardMatrix[w][A];T.includes(w)&&p.includes(A)&&!W.includes([w,A].toString())&&i.boardMatrix[w][A].type!=="Wall"&&i.boardMatrix[w][A]!==this.preVisited&&(d.push(i.boardMatrix[w][A]),f.set(v,P))}W.includes(x.toString())||(W.push(x.toString()),this.showAlgorithmStep.push(P))}}(s==="Pinky"||this.frightened)&&(this.nextTileCoord=this._assignRandomNextTileCoord()),this.preVisited=i.boardMatrix[this.tile[0]][this.tile[1]],this._moveToCenterOfTile()}_DijkstrasAlgorithm(e,t,i,s,C){let f=new Map,W=[];W.push([0,t]);let d=[],a=[],c=e.boardMatrix;for(;W.length!==0;){W=W.sort(function(x,m){return m[0]-x[0]});let l=W.pop(),o=l[1],P=l[0];if(o===i){for(console.log("Kees is there");Array.from(f.keys()).includes(o);)o=f.get(o),a.push(o);this._determineNextTilePos(a,s,C,e),this.path=a;return}d.push([Math.floor((o.yMiddle-200)/20),Math.floor((o.xMiddle-200)/20)].toString());for(let x of o.neighbors){let m=[Math.floor((x.yMiddle-200)/20),Math.floor((x.xMiddle-200)/20)],p=[...Array(c[0].length).keys()];[...Array(c.length).keys()].includes(m[0])&&p.includes(m[1])&&!d.includes(m.toString())&&x.type!=="Wall"&&x!==this.preVisited&&(f.set(x,o),W.push([P+1,x]),this.showAlgorithmStep.push(x))}}(s==="Pinky"||this.frightened)&&(this.nextTileCoord=this._assignRandomNextTileCoord()),this.preVisited=e.boardMatrix[this.tile[0]][this.tile[1]],this._moveToCenterOfTile()}_GreedyBestFirstSearch(e,t,i,s,C){let f=[],W=new Map,d=[],a=e.boardMatrix,c=Math.abs(t.xMiddle-i.xMiddle),l=Math.abs(t.yMiddle-i.yMiddle),o=[[Math.sqrt(c*c+l*l),t]];for(;o.length!==0;){o=o.sort(function(p,T){return T[0]-p[0]});let x=o.pop()[1];if(x===i){for(console.log("Kees is there");Array.from(W.keys()).includes(x);)x=W.get(x),d.push(x);this._determineNextTilePos(d,s,C,e),this.path=d;return}f.push([x.yMiddle,x.xMiddle].toString());let m;for(m of x.neighbors){let p=[Math.floor((m.yMiddle-200)/20),Math.floor((m.xMiddle-200)/20)],T=[...Array(a[0].length).keys()],y=[...Array(a.length).keys()];if(T.includes(p[1])&&y.includes(p[0])&&!f.includes([m.yMiddle,m.xMiddle].toString())&&m.type!=="Wall"&&m!==this.preVisited){let w=Math.abs(m.xMiddle-i.xMiddle),A=Math.abs(m.yMiddle-i.yMiddle);o.push([Math.sqrt(w*w+A*A),m]),W.set(m,x),this.showAlgorithmStep.push(m)}}}(s==="Pinky"||this.frightened)&&(this.nextTileCoord=this._assignRandomNextTileCoord()),this.preVisited=e.boardMatrix[this.tile[0]][this.tile[1]],this._moveToCenterOfTile()}_aStarAlgorithm(e,t,i,s,C){let f=0,W=[];W.push([0,f,t]);let d=new Map,a=new Map,c=new Map,l=[],o=e.boardMatrix;for(let p=0;p<o.length;p++)for(let T=0;T<o[p].length;T++){if(!o[p][T]||o[p][T].type==="Wall"||o[p][T].type==="None")continue;let y=o[p][T];a.set(y,1/0),c.set(y,1/0)}a.set(t,0);let P=Math.abs(t.xMiddle-i.xMiddle),x=Math.abs(t.yMiddle-i.yMiddle);c.set(t,Math.sqrt(P*P+x*x));let m=new Set;for(m.add(t);W.length!==0;){let p=W.sort(function(y,w){return w[0]-y[0]}),T=p.pop()[2];if(console.log(p),m.delete(T),T===i){for(;Array.from(d.keys()).includes(T);)T=d.get(T),l.push(T);this._determineNextTilePos(l,s,C,e),this.path=l;return}for(let y of T.neighbors)if(y&&y.type!=="Wall"&&y.type!=="None"&&y!==this.preVisited){let w=a.get(T)+1;if(w<a.get(y)){d.set(y,T),a.set(y,w);let A=Math.abs(y.xMiddle-i.xMiddle),v=Math.abs(y.yMiddle-i.yMiddle),H=Math.sqrt(A*A+v*v);c.set(y,w+H),m.has(y)||(f+=1,W.push([c.get(y),f,y]),m.add(y))}this.showAlgorithmStep.push(y)}}(s==="Pinky"||this.frightened)&&(this.nextTileCoord=this._assignRandomNextTileCoord()),this.preVisited=e.boardMatrix[this.tile[0]][this.tile[1]],this._moveToCenterOfTile()}move(e,t,i,s,C,f){if(e.middlePosTile.some(d=>d[0]===this.xPos&&d[1]===this.yPos)){this.showAlgorithmStep=[];let d=e.boardMatrix[this.tile[0]][this.tile[1]],a,c;if(this.touched)this.endTile=e.boardMatrix[7][14];else{if(i==="Blinky")a=t.tile[1],c=t.tile[0];else if(i==="Pinky")a=t.fourTilesAhead[1],c=t.fourTilesAhead[0];else if(i==="Inky"){let x=C.determineTarget(f,t,e);a=x[1],c=x[0]}else a=t.fourTilesAhead[1],c=t.fourTilesAhead[0];this.endTile=this._determineEndtile(e,c,a)}let l=t.xPos-this.xPos,o=t.yPos-this.yPos,P=Math.sqrt(l*l+o*o);if(this.touched&&P<this.radius+t.radius&&(this.preVisited=e.boardMatrix[t.tile[0]][t.tile[1]]),this.phaseChange){this.nextTileCoord=this.prevTileCoord,this.phaseChange=!1,this.preVisited=e.boardMatrix[this.tile[0]][this.tile[1]],this._moveToCenterOfTile();return}this._determine_neighbors(e.boardMatrix),this.algorithm==="aStar"?this._aStarAlgorithm(e,d,this.endTile,i,s):this.algorithm==="dfs"?(this._dfsAlgorithm(e,i,s),console.log("Executed")):this.algorithm==="bfs"?(this._bfs(d,this.endTile,e,i,s),console.log("Executed BFS")):this.algorithm==="Dijkstra"?this._DijkstrasAlgorithm(e,d,this.endTile,i,s):this.algorithm==="GreedyBestFirstSearch"&&this._GreedyBestFirstSearch(e,d,this.endTile,i,s)}else this._moveToCenterOfTile();this.tile=[Math.floor((this.yPos-200)/20),Math.floor((this.xPos-200)/20)]}becomeFrightened(){this.frightened=!0,this.phaseChange=!0,this.speed=1,this.color="blue"}}class te extends E{constructor(e){super(e),this.xPos=490,this.yPos=350,this.color="red",this.tile=[(this.yPos-210)/20,(this.xPos-210)/20];let t=e.boardMatrix[1].length-2,i=e.boardMatrix[1].length-8;this.home=[e.boardMatrix[1][t],e.boardMatrix[1][i]],this.homeTarget=e.boardMatrix[1][t],this.name="Blinky"}}class ie extends E{constructor(e){super(e),this.xPos=530,this.yPos=350,this.color="pink",this.tile=[(this.yPos-210)/20,(this.xPos-210)/20],this.home=[e.boardMatrix[1][1],e.boardMatrix[1][4]],this.homeTarget=e.boardMatrix[1][1],this.name="Pinky"}enter(){!this.hasEntered&&this.xPos!==490?this.xPos-=1:this.tile=[(this.yPos-210)/20,(this.xPos-210)/20]}}class se extends E{constructor(e){super(e),this.xPos=570,this.yPos=370,this.color="lightblue",this.tile=[(this.yPos-210)/20,(this.xPos-210)/20];let t=e.boardMatrix.length-2,i=e.boardMatrix.length-2,s=e.boardMatrix[t].length-2,C=e.boardMatrix[t].length-10;this.home=[e.boardMatrix[t][s],e.boardMatrix[i][C]],this.homeTarget=e.boardMatrix[t][s],this.name="Inky"}determineTarget(e,t,i){let s=t.fourTilesAhead[1]-Math.floor(e.tile[1]),C=t.fourTilesAhead[0]-Math.floor(e.tile[0]),f=i.boardMatrix.length,W=i.boardMatrix[0].length,d,a;return C>=0?t.fourTilesAhead[0]+C>f-2?a=f-2:a=t.fourTilesAhead[0]+C:t.fourTilesAhead[0]+C<1?a=1:a=t.fourTilesAhead[0]+C,s>=0?t.fourTilesAhead[1]+s>W-2?d=W-2:d=t.fourTilesAhead[1]+s:t.fourTilesAhead[1]+s<1?d=1:d=t.fourTilesAhead[1]+s,t.findEligibleTile(i,a,d)}enter(){!this.hasEntered&&(this.xPos!==490||this.yPos!==350)?(!this.hasEntered&&this.yPos!==350?this.yPos-=1:!this.hasEntered&&this.xPos!==490&&(this.xPos-=1),console.log(this.xPos,this.yPos)):this.tile=[(this.yPos-210)/20,(this.xPos-210)/20]}}class le extends E{constructor(t){super(t);h(this,"lost");this.xPos=570,this.yPos=330,this.color="orange",this.tile=[(this.yPos-210)/20,(this.xPos-210)/20];let i=t.boardMatrix.length-2,s=t.boardMatrix.length-6;this.home=[t.boardMatrix[i][1],t.boardMatrix[s][1]],this.homeTarget=t.boardMatrix[i][1],this.name="Clyde",this.lost=!1}enter(){!this.hasEntered&&(this.xPos!==490||this.yPos!==350)?!this.hasEntered&&this.yPos!==350?this.yPos+=1:!this.hasEntered&&this.xPos!==490&&(console.log("Kees here"),this.xPos-=1):this.tile=[(this.yPos-210)/20,(this.xPos-210)/20]}}class O{constructor(e,t,i){h(this,"text");h(this,"fillColor");h(this,"textColor");h(this,"x");h(this,"y");h(this,"width");h(this,"height");this.text=e,this.fillColor=t,this.textColor=i,this.x=0,this.y=0,this.width=0,this.height=0,this.onClick=this.onClick.bind(this)}onClick(){console.log("Button was clicked!")}setPosition(e,t){this.x=e,this.y=t}setSize(e,t){this.width=e,this.height=t}draw(e){e.fillStyle=this.fillColor,e.fillRect(this.x,this.y,this.width,this.height),e.fillStyle=this.textColor,e.textAlign="center",e.textBaseline="middle",e.font="25px arial",e.fillText(this.text,this.x+this.width/2,this.y+this.height/2,this.width)}inBounds(e,t){return!(e<this.x||e>this.x+this.width||t<this.y||t>this.y+this.height)}}let M=document.querySelector("canvas");const V=document.getElementById("algorithmDropdown"),q=document.getElementById("showAlgorithmPathDiv");let _=document.getElementById("StartModelEl");const r=M==null?void 0:M.getContext("2d");M.width=window.innerWidth;M.height=window.innerHeight;function oe(n){for(let e of k)e.algorithm=n.target.value}function re(){for(let n of k)n.showAlgorithm=!n.showAlgorithm}V.addEventListener("change",oe);q.addEventListener("change",re);var S={};window.addEventListener("keydown",function(n){S[n.key]=!0,n.preventDefault()});window.addEventListener("keyup",function(n){delete S[n.key]});function he(){let n=[],e=new O("Restart Game","#eeaa00","black"),t=new O("Back to main","#eeaa00","black");return e.setPosition(M.width/2-200,M.height/2),t.setPosition(M.width/2+50,M.height/2),t.onClick=()=>{document.location.reload()},e.onClick=()=>{N(),M.removeEventListener("click",U)},n.push(e),n.push(t),n.forEach(i=>i.setSize(150,75)),n}let u,g,G,R,b,Y,k,L,I,F,j=he();function N(){L=20,I=7,F=10,u=new X(0,0),g=new Z(L,I,F),G=new te(g),R=new ie(g),b=new se(g),Y=new le(g),k=[G,R,Y,b],g.time=0}function ne(){let n=u;u=new X(n.lives,n.score),G.xPos=490,G.yPos=350,Y.xPos=570,Y.yPos=330,b.xPos=570,b.yPos=370,R.xPos=530,R.yPos=350,g.lifeLost=!1,g.gameOverScreen=!1;for(let e of k)e.touched=!1,e.frightened=!1,e.tile=[Math.floor((e.yPos-200)/20),Math.floor((e.xPos-200)/20)],e.name!=="Blinky"&&(e.hasEntered=!1),console.log(e);g.time=1}function K(){r.fillStyle="black",r==null||r.fillRect(g.xPos,g.yPos,g.width,g.height);for(let t=0;t<g.boardMatrix.length;t++)for(let i=0;i<g.boardMatrix[0].length;i++)if(g.boardMatrix[t][i]){if(g.boardMatrix[t][i].type==="Coin"&&(r.fillStyle=g.boardMatrix[t][i].color),g.boardMatrix[t][i].type==="Wall"){r.strokeStyle=g.boardMatrix[t][i].color,r.lineWidth=2,r==null||r.beginPath();let s=g.boardMatrix[t][i];s.wallDir==="leftToRight"?(r==null||r.moveTo(s.xPos,s.yPos+10),r==null||r.lineTo(s.xPos+20,s.yPos+10)):s.wallDir==="upToBottom"?(r==null||r.moveTo(s.xPos+10,s.yPos),r==null||r.lineTo(s.xPos+10,s.yPos+20)):s.wallDir==="rightToBottom"?(r==null||r.moveTo(s.xPos+20,s.yPos+10),r==null||r.arcTo(s.xPos+10,s.yPos+10,s.xPos+10,s.yPos+20,10)):s.wallDir==="leftToBottom"?(r==null||r.moveTo(s.xPos,s.yPos+10),r==null||r.arcTo(s.xPos+10,s.yPos+10,s.xPos+10,s.yPos+20,10)):s.wallDir==="rightToTop"?(r==null||r.moveTo(s.xPos+20,s.yPos+10),r==null||r.arcTo(s.xPos+10,s.yPos+10,s.xPos+10,s.yPos,10)):s.wallDir==="leftToTop"&&(r==null||r.moveTo(s.xPos,s.yPos+10),r==null||r.arcTo(s.xPos+10,s.yPos+10,s.xPos+10,s.yPos,10)),r==null||r.stroke()}else if(g.boardMatrix[t][i].type==="Coin"){let s=g.boardMatrix[t][i];r.fillStyle="orange",r.beginPath(),r.moveTo(u.xPos,u.yPos),r.arc(s.xPos+10,s.yPos+10,2,0,90,!1),r.lineTo(u.xPos,u.yPos),r.fill(),g.playerCoinCollision(u,s)}else if(g.boardMatrix[t][i].type==="PowerUpCoin"){let s=g.boardMatrix[t][i];s.updateLightness(),r.fillStyle=`hsl(62,100%,${s.lightness}%)`,r.beginPath(),r.moveTo(u.xPos,u.yPos),r.arc(s.xPos+10,s.yPos+10,10,0,90,!1),r.lineTo(u.xPos,u.yPos),r.fill();let C=g.playerCoinCollision(u,s);if(C&&C==="PowerUpCoin")for(let f of k)f.becomeFrightened(),f.beginTimeFrightened=Math.floor(Date.now()/1e3),f.endTimeFrightened=Math.floor(Date.now()/1e3)}r.fillStyle="red"}let n=220,e=570;r.fillStyle="yellow";for(let t=0;t<u.lives;t++){r.beginPath(),r.moveTo(n,e);let i=Math.PI+.55,s=Math.PI-.55;r.arc(n,e,10,i,s,!1),r.lineTo(n,e),r.fill(),n+=30}}const U=n=>{let e=n.pageX-(M.clientLeft+M.offsetLeft),t=n.pageY-(M.clientTop+M.offsetTop);j.forEach(i=>{i.inBounds(e,t)&&i.onClick&&i.onClick()})};function de(n,e){r.fillStyle="#808080",r.beginPath(),r==null||r.roundRect(M.width/3,M.height/3,M.width/3,M.height/3,50),r.fill(),r.font="20px Courier New",r.textAlign="center",r.strokeStyle="white",r.strokeText("Oh he dead",M.width/2,M.height/2-80),e.gameOverScreen||(M.addEventListener("click",U),e.gameOverScreen=!0),n.forEach(t=>t.draw(r))}function ae(){if(g.lifeLost)Math.abs(u.startAngle-u.endAngle)<=Math.PI*2-.155?u.caught():(u.dead=!0,u.explosion||(u.explosion=u.createExplosion(u)),u.explosion.forEach((t,i)=>{t.alpha<=0?u.explosion.splice(i,1):t.update(r)})),u.explosion&&u.explosion.length===0&&(u.lives>0?(u.lives-=1,ne()):de(j,g));else{if(u.updateDirection(S,g),u.direction==="right")var n=u.xPos+u.speed,e=u.yPos;else if(u.direction==="left")var n=u.xPos-u.speed,e=u.yPos;else if(u.direction==="up")var n=u.xPos,e=u.yPos-u.speed;else var n=u.xPos,e=u.yPos+u.speed;g.checkPlayerWallCollision(u,n,e)||u.move(S,g)}}function We(){u.dead||(r.beginPath(),r.moveTo(u.xPos,u.yPos),r.arc(u.xPos,u.yPos,u.radius,u.startAngle,u.endAngle,!1),r.lineTo(u.xPos,u.yPos),r.fillStyle="yellow",r.fill(),Object.keys(S).length!==0&&(u.mouthDirection==="Open"?(u.startAngle+=.08,u.endAngle-=.08):(u.startAngle-=.08,u.endAngle+=.08)),Math.abs(u.startAngle-u.endAngle)>2.5?u.mouthDirection="Close":Math.abs(u.startAngle-u.endAngle)<.17&&(u.mouthDirection="Open"))}function fe(){for(let n of k)if(r.fillStyle=n.color,r==null||r.beginPath(),r==null||r.arc(n.xPos,n.yPos,n.radius,0,2*Math.PI),r==null||r.fill(),n.hasEntered&&(n.move(g,u,n.name,n.mode,b,G),n.showAlgorithm&&n.name==="Pinky")){n.showAlgorithmStep.map(i=>r.fillRect(i.xPos+5,i.yPos+5,10,10)),r.fillStyle="green";let e=n.endTile.xPos,t=n.endTile.yPos;r.fillRect(e+5,t+5,10,10),r.fillStyle="red",n.path.map(i=>r.fillRect(i.xPos+5,i.yPos+5,10,10))}}function ue(){r==null||r.clearRect(0,0,M.width,M.height),r.fillStyle="black",r==null||r.fillRect(0,0,M.width,M.height),K(),We(),g.lifeLost||fe()}function Ce(){for(let n of k)if(!n.frightened)n.mode==="chase"?n.endTimeMode-n.beginTimeMode>g.chaseTimeOut?(n.mode="scatter",n.beginTimeMode=Math.floor(Date.now()/1e3),n.endTimeMode=Math.floor(Date.now()/1e3),n.phaseChange=!0):n.endTimeMode=Math.floor(Date.now()/1e3):n.mode==="scatter"&&(n.endTimeMode-n.beginTimeMode>g.scatterTimeOut?(n.mode="chase",n.beginTimeMode=Math.floor(Date.now()/1e3),n.endTimeMode=Math.floor(Date.now()/1e3),n.phaseChange=!0):n.endTimeMode=Math.floor(Date.now()/1e3));else{let e=n.xPos%2===0&&n.yPos%2===0;n.endTimeFrightened-n.beginTimeFrightened>g.frightenedTimeOut&&e||n.touched&&n.xPos===490&&n.yPos===350?g.endFrightened(n):n.endTimeFrightened=Math.floor(Date.now()/1e3)}}function B(){g.time+=1,ue(),ae();const n=e=>e.type!=="coin";if(!g.boardMatrix.flat().some(n))g.flicker===0&&setTimeout(()=>{console.log("Timeout")},1500),g.boardMatrix.map(e=>e.map(t=>t.hasOwnProperty("color")&&t.color==="blue"?t.color="white":t.hasOwnProperty("color")&&t.color==="white"?t.color="blue":console.log("Nothing"))),g.flicker<=7&&(g.flicker+=1,setTimeout(()=>{window.requestAnimationFrame(B)},500));else{if(!g.lifeLost){g.time>=100&&!R.hasEntered&&(R.enter(),R.tile=[(R.yPos-210)/20,(R.xPos-210)/20],R.xPos===490&&R.yPos===350&&(R.hasEntered=!0)),Y.hasEntered||u.score>=1e3&&g.time>=50&&(Y.enter(),Y.tile=[(Y.yPos-210)/20,(Y.xPos-210)/20],Y.xPos===490&&Y.yPos===350&&(Y.hasEntered=!0)),b.hasEntered||u.score>=500&&g.time>=150&&(b.enter(),b.tile=[(b.yPos-210)/20,(b.xPos-210)/20],b.xPos===490&&b.yPos===350&&(b.hasEntered=!0)),Ce();for(let e of k)g.checkPlayerGhostcollision(e,u)}window.requestAnimationFrame(B)}}N();function z(){r==null||r.clearRect(0,0,M.width,M.height),r.fillStyle="black",r==null||r.fillRect(0,0,M.width,M.height),K(),window.requestAnimationFrame(z)}const ce=window.requestAnimationFrame(z);_.addEventListener("click",()=>{N(),B(),V.style.display="inline-block",q.style.display="inline-block",_.style.display="none",cancelAnimationFrame(ce)});
